<ngx-loading [show]="loading"></ngx-loading>
<div class="row ml-1 mt-3 mr-1">
  <div class="col-sm-12 col-md-8 col-lg-8 col-xl-8">
    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <span class="label label-default d-none d-lg-block small mr-auto"><small class="text-muted">Simulación del cálculo del costo de  las maniobras.</small></span>
          </div>
        </div><!-- end ROW -->
        <form [formGroup]="calculoForm">
          <div class="row mt-2">
            <div class="col-12 styled-select">
              <label id="sTipoEntrada" class="text-muted" >Tipo de Entrada</label>
              <mat-radio-group formControlName="sTipoEntrada" name="sTipoEntrada" id="sTipoEntrada" (change)="visibImport = !visibImport" [(ngModel)]="calculoManiobra.TipoEntrada" >
                <!-- <mat-radio-button class="col" *ngFor="let option of getTipoIngreso" [value]="option.Clave" color="primary">                      
                    {{option.Concepto}}
                  </mat-radio-button>        -->
                <div class="row mt-1">
                  <mat-radio-button [checked]="true" class="col" value="I" color="primary">                      
                    Importación
                  </mat-radio-button>                    
                  <mat-radio-button class="col" value="E" color="primary">                      
                    Exportación
                  </mat-radio-button>                    
                </div>  
              </mat-radio-group>
            </div><!-- end col -->
          </div><!-- end ROW -->
          <div class="row mt-2" *ngIf="!visibImport">
            <div class="col-md-6 styled-select">
              <mat-form-field class="input-full-width">
                <input matInput type="text"  [(ngModel)]="calculoManiobra.Master" [textMask]="{mask: masterMask, guide: false, modelClean: true}" formControlName="tMaster" name="tMaster"  placeholder="Guía Master" required />
                <mat-error *ngIf="calculoForm.get('tMaster').errors?.required">
                   * El campo Guía Master es <strong>requerido</strong>
                </mat-error> 
                <mat-error *ngIf="calculoForm.get('tMaster').errors?.pattern">
                   * El campo Guía Master es <strong>incorrecto</strong>
                </mat-error>
              </mat-form-field>
            </div><!-- end col -->
            <div class="col-md-6 styled-select">
              <mat-form-field class="input-full-width">
                <input matInput type="text"  [(ngModel)]="calculoManiobra.House" formControlName="tHouse" placeholder="Guía House" required/>
                <mat-error *ngIf="calculoForm.get('tHouse').errors?.required">
                  *  El campo Guía House es <strong>requerido</strong>
                </mat-error> 
                <mat-error *ngIf="calculoForm.get('tHouse').errors?.pattern">
                   * El campo Guía House es <strong>incorrecto</strong>
                </mat-error>
              </mat-form-field>
            </div><!-- end col -->
          </div><!-- end ROW -->
          <div class="row mt-2" *ngIf="visibImport">
            <div class="col-12 styled-select">
              <mat-form-field class="input-full-width">
                <mat-select [(ngModel)]="calculoManiobra.ConceptoCadenaFria" class="" formControlName="sConceptoCadenaFria" name="sConceptoCadenaFria" required placeholder="Rango de temperatura" >
                  <mat-option *ngFor="let elemt of getCadena " [value]="elemt.Concepto"> 
                  {{elemt.Concepto}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="calculoForm.get('sConceptoCadenaFria').errors?.required">
                 * El campo Rango de temperatura es <strong>requerido</strong>
                </mat-error>                  
              </mat-form-field>
            </div><!-- end col -->
          </div><!-- END row -->
          <div class="row mt-2">
            <div class="col-md-6 styled-select" *ngIf="!visibImport" >
              <mat-form-field class="input-full-width">
                <input matInput type="text" [(ngModel)]="calculoManiobra.FechaSalida" formControlName="fechaSalidaCtrl" #dp="bsDatepicker" bsDatepicker placement="top" placeholder="Fecha de Salida" >
                <mat-error *ngIf="calculoForm.get('fechaSalidaCtrl').errors?.required">
                   * El campo Fecha de Salida es <strong>requerido</strong>
                </mat-error>  
              </mat-form-field>
            </div><!-- end col -->
            <div class="col-md-6 styled-select" *ngIf="visibImport">
              <mat-form-field class="input-full-width">
                <input matInput type="text"  [(ngModel)]="calculoManiobra.Peso" formControlName="sPeso" name="sPeso"  placeholder="Peso" required />
                <span matSuffix>Kg.</span>
                <mat-error *ngIf="calculoForm.get('sPeso').errors?.required">
                   * El campo Peso es <strong>requerido</strong>
                </mat-error> 
                <mat-error *ngIf="calculoForm.get('sPeso').errors?.pattern">
                   * El campo Peso debe ser un <strong>número</strong> con máximo 2 decimales.
                </mat-error>
              </mat-form-field>
            </div><!-- end col -->
            <div class="col-md-6 styled-select">
              <mat-form-field class="input-full-width">
                <input matInput type="text"  [(ngModel)]="calculoManiobra.ValorAduana" formControlName="sValorAduana"placeholder="Valor Aduana" pattern="^[+-]?([0-9]*[.])?[0-9]+$" required/>
                <mat-error *ngIf="calculoForm.get('sValorAduana').errors?.required">
                   * El campo Valor Aduana es <strong>requerido</strong>
                </mat-error> 
                <mat-error *ngIf="calculoForm.get('sValorAduana').errors?.pattern">
                   * El campo Valor Aduana debe ser <strong>número</strong> con máximo 2 decimales.
                </mat-error>
              </mat-form-field>
            </div><!-- end col -->
          </div><!-- end ROW -->
          <hr class="dividerb">
          <div class="row mt-3">
            <div class="col-lg-12 text-center">
              <button (click)="clean(); "  class="btn btn-pill btn-primary btn-sm btn-save-forms mb-1 mb-md-0 mr-1 ml-1">Limpiar</button>            
              <button  (click)="(visibImport)?calcularExport():calcularImport()" class="btn btn-pill btn-primary btn-sm btn-save-forms mb-1 mb-md-0 mr-1 ml-1">Calcular</button>
            </div>
          </div><!-- end ROW -->
        </form>
        <div class="row mt-2">
          <div class="col-12">
            <span class="label label-default d-none d-lg-block small">Los datos marcados con * son obligatorios.</span>
          </div>
          <!-- <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <span class="label label-default d-none d-lg-block small">Este simulador, no es la cotización final, sujeto a cambio.</span>
          </div> -->
        </div><!-- end ROW -->
      </div><!-- Card Body-->
    </div><!--END Card calculadora -->
  </div><!--END Card calculadora right side-->


  <div class="col-sm-12 col-md-4 col-lg-4">
    <div class="card" width="100%">
        <div class="card-body">
          <div class="row">
            <div class="col-12">
              <h6>Resultado del Cálculo</h6>
            </div>
          </div><!-- end ROW -->
          <div class="row" >
            <div class="col-12" *ngIf="resCalcuo.CostoAlmacenaje > '0' ">
              <mat-form-field class="input-full-width">
                <input matInput type="text" readonly style="text-align: right;" [(ngModel)]="resCalcuo.CostoAlmacenaje" placeholder="Costo Almacenaje" [ngModelOptions]="{standalone: true}">
                <span matPrefix>$</span>
              </mat-form-field>
            </div><!-- end Col -->
            <div class="col-12" *ngIf="resCalcuo.CostoCustodia > '0' ">
              <mat-form-field class="input-full-width">
                <input matInput type="text" readonly style="text-align: right;" [(ngModel)]="resCalcuo.CostoCustodia" placeholder="Costo Custodia" [ngModelOptions]="{standalone: true}">
                <span matPrefix>$</span>
              </mat-form-field>
            </div><!-- end Col -->
            <div class="col-12" *ngIf="resCalcuo.CostoManiobra > '0' ">
              <mat-form-field class="input-full-width">
                <input matInput type="text" readonly style="text-align: right;" [(ngModel)]="resCalcuo.CostoManiobra" placeholder="Costo Maniobra" [ngModelOptions]="{standalone: true}">
                <span matPrefix>$</span>
              </mat-form-field>
            </div><!-- end Col -->
            <div class="col-12" *ngIf="resCalcuo.CostoRefrigeracion > '0' ">
              <mat-form-field class="input-full-width">
                <input matInput type="text" readonly style="text-align: right;" [(ngModel)]="resCalcuo.CostoRefrigeracion" placeholder="Costo Refrigeracion" [ngModelOptions]="{standalone: true}">
                <span matPrefix>$</span>
              </mat-form-field>
            </div><!-- end Col -->
            <div class="col-12" *ngIf="resCalcuo.CostoTEC > '0' ">
              <mat-form-field class="input-full-width">
                <input matInput type="text" readonly style="text-align: right;" [(ngModel)]="resCalcuo.CostoTEC" placeholder="Costo TEC" [ngModelOptions]="{standalone: true}">
                <span matPrefix>$</span>
              </mat-form-field>
            </div><!-- end Col -->
          </div>
          <hr class="dividerb">
          <div class="row" >
            <div class="col-12" *ngIf="resCalcuo.Total > '0' ">
              <mat-form-field class="input-full-width">
                <input matInput type="text" readonly style="text-align: right;" [(ngModel)]="resCalcuo.Total" placeholder="Total" [ngModelOptions]="{standalone: true}">
                <span matPrefix>$</span>
              </mat-form-field>
            </div><!-- end Col -->
            
          </div><!-- end ROW -->
        </div><!-- Card Body-->
    </div><!--END Card calculadora -->    
  </div><!--END CARD resultados calculadora left side-->
</div>
<div class="row mb-2 mt-0">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="font-size: 0.7rem; font-weight: bold; float:left;" >
      * Este simulador, no es la cotización final, sujeto a cambio.
    </div>
  </div><!-- end ROW -->