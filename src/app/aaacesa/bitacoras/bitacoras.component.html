<ngx-loading [show]="loading" [config]="{ fullScreenBackdrop: true }"></ngx-loading>
<div class="container">
  
</div>
<div class="animated fadeIn">
  <div class="card">
    <div class="card-body">
      <!-- Start Busqueda Superior -->
      <div class="row mb-3">
        <div class="col-lg-8 mr-0 pr-0">
          <div class="row">

            <!-- busqueda rango fechas -->
            <div class="col-lg-3 mb-1 invalid--no-color">
              <mat-form-field class="input-full-width">
                <input matInput type="text" [(ngModel)]="rangoFechaSearch" #fechaSearch bsDaterangepicker placement="right top" class="rangoFecha" placeholder="Rango de Fecha">
              </mat-form-field>
            </div>

            <!-- busqueda modulo -->
            <div class="col-lg-3 mb-1">
              <mat-form-field class="input-full-width">
                <mat-select [(ngModel)]="busquedaBit.Modulo" placeholder="Módulo" #singleSelect>
                  <mat-option>                      
                    <ngx-mat-select-search [(ngModel)]="moduloSearch" [placeholderLabel]="'Buscar'" [noEntriesFoundLabel]="'No hay coincidencias'"></ngx-mat-select-search>
                  </mat-option>
                  <mat-option [value]="">TODOS</mat-option>                    
                  <mat-option *ngFor="let option of modulosGet | filterSelectSingle: moduloSearch" [value]="option"> 
                    {{option}}
                  </mat-option>
                </mat-select>                  
              </mat-form-field>
            </div>

            <!-- busqueda usuario -->
            <div class="col-lg-5 mb-1">
              <mat-form-field class="input-full-width">
                <mat-select [(ngModel)]="busquedaBit.IdCuentaEspecifica" class="" placeholder="Usuario" #singleSelect>
                  <mat-option>                      
                    <ngx-mat-select-search [(ngModel)]="usuarioSearch" [placeholderLabel]="'Buscar'" [noEntriesFoundLabel]="'No hay coincidencias'"></ngx-mat-select-search>
                  </mat-option>
                  <mat-option [value]="">TODOS</mat-option>                    
                  <mat-option *ngFor="let option of usuariosGet | filterSelect: usuarioSearch" [value]="option['IdCliente']"> 
                    {{option['Nombre']}}
                  </mat-option>
                </mat-select>                  
              </mat-form-field>
            </div>
          </div>
          <!-- end row -->
        </div>

        <div class="col-lg-3 d-none d-sm-block d-md-block d-lg-block d-xl-block">
            <div class="row justify-content-center">
              <div class="col-xs-6 col-sm-3 col-md-3 col-lg-12 col-xl-5 mb-1 align-self-end">
                <button (click)="buscarBitacoras()" style="float:right" class="btn btn-pill btn-primary btn-sm"> <i class="fas fa-search"></i> Buscar</button>
              </div>
              <div class="col-xs-6 col-sm-4 col-md-4 col-lg-12 col-xl-7 mb-1 align-self-start">              
                <button (click)="limpiarFlitros()" class="btn btn-pill btn-primary btn-sm nueva-busqueda"> Nueva Búsqueda</button>
              </div>
            </div>
          </div> <!-- End Botones md,lg,xl-->
          <div class="col-lg-3 ml-0 d-block d-sm-none">
            <div class="row justify-content-center">
              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-5 mb-1 text-center">
                <button (click)="buscarBitacoras()" class="btn btn-pill btn-primary btn-sm mr-3"> <i class="fas fa-search"></i> Buscar</button>
                <button (click)="limpiarFlitros()" class="btn btn-pill btn-primary btn-sm"> Nueva Búsqueda</button>
              </div>
            </div>
          </div> <!-- End Botones sm-->  
      </div>      
      <!-- End Busqueda Superior -->

      <div class="row mb-3" *ngIf="visibleRes" >
        <div class="col-md-4 offset-md-8">
          <mat-form-field class="input-full-width">
            <input matInput (keyup)="applyFilter($event.target.value)" type="text" placeholder="Buscar..." />
            <mat-icon matSuffix><i class="fa fa-search"></i></mat-icon>
          </mat-form-field>
        </div>
      </div>

      <div class="table-responsive">
        <table mat-table [dataSource]="dataSource" matSort>

          <!-- Usuario Column -->
          <ng-container matColumnDef="Nombre">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Usuario </th>
            <td mat-cell *matCellDef="let element"> {{ element.Nombre }} </td>
          </ng-container>

          <!-- Acciones Column -->
          <ng-container matColumnDef="Accion">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Acciones de uso</th>
            <td mat-cell *matCellDef="let element"> {{ element.Accion }} </td>
          </ng-container>

          <!-- Detalles Column -->
          <ng-container matColumnDef="Detalle">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Detalles de acción </th>
            <td mat-cell *matCellDef="let element"> {{ element.Detalle }} </td>
          </ng-container>

          <!-- fecha Column -->
          <ng-container matColumnDef="Fecha">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha de Acción</th>
            <td mat-cell *matCellDef="let element"> {{ element.FechaCreacion.split(' ')[0]  }} </td>
          </ng-container>

           <!-- Hora Column -->
           <ng-container matColumnDef="Hora">
            <th mat-header-cell *matHeaderCellDef> Hora de acceso </th>
            <td mat-cell *matCellDef="let element"> {{ element.FechaCreacion.split(' ')[1] }} </td>
          </ng-container>


          <tr mat-header-row *matHeaderRowDef="displayedColumns" ></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator [length]="100"
                       [pageSize]="10"
                       [pageSizeOptions]="[5, 10, 25, 100]">
        </mat-paginator>
      </div>
    </div>
  </div>
</div>
